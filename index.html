<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aplikasi Absen Profesional</title>

  <style>
    :root {
      --bg: #f3f6fb;
      --card: #ffffff;
      --accent: #2563eb;
      --accent-hover: #1d4ed8;
      --border: #e5e7eb;
      --text: #1e293b;
      --text-light: #64748b;
    }

    body {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 32px;
      background: var(--bg);
      color: var(--text);
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 28px;
      box-shadow: 0 10px 28px rgba(28, 39, 64, 0.08);
      border: 1px solid var(--border);
    }

    h1 {
      margin: 0 0 8px;
      font-size: 26px;
      font-weight: 700;
      color: var(--text);
    }

    p.lead {
      margin: 0 0 22px;
      color: var(--text-light);
      font-size: 15px;
    }

    input[type="text"] {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      font-size: 14px;
      width: 220px;
    }

    .btn {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 10px 18px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s ease;
    }

    .btn:hover {
      background: var(--accent-hover);
    }

    .btn.red { background: #dc2626; }
    .btn.red:hover { background: #b91c1c; }

    .play-area {
      background: var(--card);
      border-radius: 12px;
      border: 1px dashed #dbe3f1;
      height: 260px;
      position: relative;
      overflow: hidden;
      padding: 14px;
      margin-top: 16px;
    }

    .row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eef2ff;
    }

    .row:last-child {
      border-bottom: none;
    }

    .name {
      font-weight: 600;
      font-size: 14px;
    }

    .status {
      color: var(--text-light);
      font-size: 12px;
      margin-top: 2px;
    }

    /* Tombol melayang */
    .floating-btn {
      position: absolute;
      transform: translate(-50%, -50%);
      background: var(--accent);
      padding: 8px 14px;
      border-radius: 10px;
      color: white;
      border: none;
      cursor: pointer;
      transition: top 0.15s, left 0.15s, background 0.2s;
      font-size: 14px;
    }

    .floating-btn:hover {
      background: var(--accent-hover);
    }

    .floating-btn:disabled {
      background: #9ca3af;
      cursor: default;
    }

    .controls {
      margin-top: 16px;
      display: flex;
      gap: 18px;
      align-items: center;
      font-size: 14px;
      color: var(--text-light);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="card">

      <h1>Aplikasi Absen â€” Versi Profesional</h1>
      <p class="lead">Klik tombol "Hadir" â€” kalau bisa menangkapnya ðŸ˜„. UI minimalis profesional & tombol lebih lincah.</p>

      <div style="display:flex; gap:14px; flex-wrap:wrap; margin-bottom:6px;">
        <input id="newName" type="text" placeholder="Nama peserta" />
        <button id="addBtn" class="btn">Tambah peserta</button>
        <button id="resetBtn" class="btn red">Reset data</button>
      </div>

      <small style="color:var(--text-light); font-size:12px;">
        Data disimpan otomatis di browser (localStorage).
      </small>

      <div id="playArea" class="play-area">
        <div id="list"></div>
      </div>

      <div class="controls">
        <label><input id="avoidToggle" type="checkbox" checked /> Tombol menghindar aktif</label>
        <label>Sensitivitas: <input id="sensitivity" type="range" min="40" max="250" value="150" /></label>
      </div>

    </div>
  </div>

<script>
(function(){
  const sample = ["Ahmad","Budi","Citra","Dewi","Eka"];
  const listEl = document.getElementById("list");
  const playArea = document.getElementById("playArea");
  const newName = document.getElementById("newName");
  const addBtn = document.getElementById("addBtn");
  const resetBtn = document.getElementById("resetBtn");
  const avoidToggle = document.getElementById("avoidToggle");
  const sensitivity = document.getElementById("sensitivity");

  let participants = load() || sample.map(n => ({ name:n, present:false }));

  function save(){ localStorage.setItem("absen-pro", JSON.stringify(participants)); }
  function load(){ try { return JSON.parse(localStorage.getItem("absen-pro")); } catch { return null; } }

  function render(){
    listEl.innerHTML = "";
    playArea.querySelectorAll(".floating-btn").forEach(el => el.remove());

    participants.forEach((p, idx) => {
      const row = document.createElement("div");
      row.className = "row";

      const left = document.createElement("div");
      const name = document.createElement("div");
      name.className = "name";
      name.textContent = p.name;
      
      const status = document.createElement("div");
      status.className = "status";
      status.textContent = p.present ? "Hadir âœ“" : "Belum hadir";

      left.appendChild(name);
      left.appendChild(status);
      row.appendChild(left);

      listEl.appendChild(row);

      const btn = document.createElement("button");
      btn.className = "floating-btn";
      btn.textContent = p.present ? "Sudah" : "Hadir";
      btn.dataset.index = idx;
      if(p.present) btn.disabled = true;

      btn.style.left = (20 + Math.random()*60) + "%";
      btn.style.top = (20 + Math.random()*50) + "%";

      btn.onclick = (e) => {
        e.stopPropagation();
        if(p.present) return;
        p.present = true;
        save();
        render();
      };

      playArea.appendChild(btn);
    });
  }

  playArea.addEventListener("mousemove", e => {
    if(!avoidToggle.checked) return;

    const area = playArea.getBoundingClientRect();
    const mx = e.clientX - area.left;
    const my = e.clientY - area.top;

    const buttons = playArea.querySelectorAll(".floating-btn");
    const sens = Number(sensitivity.value);

    buttons.forEach(btn => {
      if(btn.disabled) return;

      const rect = btn.getBoundingClientRect();
      const bx = rect.left - area.left + rect.width/2;
      const by = rect.top - area.top + rect.height/2;

      const dx = bx - mx;
      const dy = by - my;
      const dist = Math.hypot(dx, dy);

      if(dist < sens){
        const angle = Math.atan2(dy, dx);
        const move = (sens - dist) * 0.9 + (20 + Math.random()*40);

        let nx = bx + Math.cos(angle)*move;
        let ny = by + Math.sin(angle)*move;

        nx = Math.max(30, Math.min(area.width-30, nx));
        ny = Math.max(30, Math.min(area.height-30, ny));

        btn.style.left = (nx / area.width * 100) + "%";
        btn.style.top = (ny / area.height * 100) + "%";
      }
    });
  });

  addBtn.onclick = () => {
    const name = newName.value.trim();
    if(!name) return alert("Nama belum diisi.");
    participants.push({name, present:false});
    save();
    render();
    newName.value = "";
  };

  resetBtn.onclick = () => {
    if(!confirm("Reset semua data?")) return;
    participants = [];
    save();
    render();
  };

  render();
})();
</script>

</body>
</html>
